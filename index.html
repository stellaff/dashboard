<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ergomotion PT Sales Explorer 2024-2026</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="lock-screen">
    <div class="lock-card">
      <h2>Ergomotion PT Sales Explorer</h2>
      <p>Enter password to view dashboard data.</p>
      <form id="unlock-form">
        <input type="password" id="password-input" placeholder="Password" autocomplete="current-password" required />
        <button type="submit" class="btn" id="unlock-btn">Unlock</button>
      </form>
      <p id="unlock-error" class="error-msg" style="display:none;"></p>
    </div>
  </div>

  <header class="hero dashboard-hidden">
    <div class="hero-inner">
      <div>
        <p class="eyebrow">Ergomotion PT - Sales Analysis</p>
        <h1>Ergomotion PT Sales Explorer 2024-2026</h1>
        <p class="subtitle">Interactive view of 2025 gross/net Sales and forecast and 2026 forecast (EUR).</p>
      </div>
    </div>
  </header>

  <main class="container dashboard-hidden">
    <div class="tabs-bar">
      <button class="tab active" data-target="board-view">Yearly Summary</button>
      <button class="tab" data-target="monthly-view">2026 Monthly Actual Sales</button>
    </div>

    <div class="note note-inline" id="yearly-note">
      <div class="note-title">Data Normalization</div>
      <div class="note-body">TRADING HOUSE ASKONA LLC + A Trade LLC -> <strong>ASKONA</strong><br />Bed Quarter Furniture Trading + Bed Quarter Company for Trading -> <strong>BED QUARTER</strong></div>
    </div>
    <section class="filters" id="yearly-filters">
      <div class="filter">
        <label for="search">Search</label>
        <input id="search" type="text" placeholder="Customer, region, category" />
      </div>
      <div class="filter">
        <label for="region">Region</label>
        <select id="region"></select>
      </div>
      <div class="filter">
        <label for="category">Customer Category</label>
        <select id="category"></select>
      </div>
      <div class="filter">
        <label for="customer">Customer (Normalized)</label>
        <select id="customer"></select>
      </div>
      <div class="filter">
        <label for="metric">Primary Metric</label>
        <select id="metric"></select>
      </div>
      <div class="filter">
        <button id="reset" class="btn">Reset filters</button>
      </div>
    </section>

    <section class="kpis" id="kpis"></section>

    <section id="board-view" class="view">
      <section class="section-title">Yearly Summary</section>
      <section class="charts board">
        <div class="chart-card">
          <h3>Top Customers by Selected Metric</h3>
          <div id="chart-top-static"></div>
        </div>
        <div class="chart-card">
          <h3>Totals Across Metrics</h3>
          <div id="chart-totals-static"></div>
        </div>
        <div class="chart-card">
          <h3>Total Sales and YoY Percent Change</h3>
          <div id="chart-yoy-static"></div>
        </div>
        <div class="chart-card">
          <h3>2025 Net Sales Distribution (Customer Category)</h3>
          <div id="chart-net-dist-static"></div>
        </div>
        <div class="chart-card">
          <h3>Regional Sales Comparison</h3>
          <div id="chart-region-bars-static"></div>
        </div>
        <div class="chart-card">
          <h3>Category Sales Comparison</h3>
          <div id="chart-category-bars-static"></div>
        </div>
        <div class="chart-card">
          <h3>Category Mix by Year Type</h3>
          <div id="chart-category-stack-static"></div>
        </div>
        <div class="chart-card">
          <h3>Category Mix Table (Percent of Sales)</h3>
          <div class="chart-table">
            <table id="category-mix-table">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Increases in 2025 Gross vs 2024 Gross</h3>
          <div id="chart-inc-gross-static"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Decreases in 2025 Gross vs 2024 Gross</h3>
          <div id="chart-dec-gross-static"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Customers Beating 2025 Forecast</h3>
          <div id="chart-beat-forecast-static"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Customers Missing 2025 Forecast</h3>
          <div id="chart-miss-forecast-static"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 2026 Forecast Increases vs 2025 Gross</h3>
          <div id="chart-inc-2026-static"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 2026 Forecast Decrease vs 2025 Gross</h3>
          <div id="chart-dec-2026-static"></div>
        </div>
      </section>
    </section>

    <section id="monthly-view" class="view hidden">
      <section class="section-title">2026 Monthly Actual Sales</section>
      <section class="filters monthly-filters">
        <div class="filter">
          <label for="monthly-month">Month</label>
          <select id="monthly-month"></select>
        </div>
        <div class="filter">
          <label for="monthly-region">Region</label>
          <select id="monthly-region"></select>
        </div>
        <div class="filter">
          <label for="monthly-category">Customer Category</label>
          <select id="monthly-category"></select>
        </div>
        <div class="filter">
          <label for="monthly-customer">Customer (Normalized)</label>
          <select id="monthly-customer"></select>
        </div>
        <div class="filter">
          <label for="monthly-metric">Primary Metric</label>
          <select id="monthly-metric"></select>
        </div>
      </section>

      <section class="kpis" id="monthly-kpis"></section>

      <section class="charts board">
        <div class="chart-card">
          <h3>Current Month Sales by Customer Category</h3>
          <div id="chart-monthly-gross-net-category"></div>
        </div>
        <div class="chart-card">
          <h3>Year-to-Date Sales by Customer Category</h3>
          <div id="chart-monthly-gross-net-region"></div>
        </div>
        <div class="chart-card">
          <h3>Top Customer (2026 Current Month Sales)</h3>
          <div id="chart-monthly-top-customer"></div>
        </div>
        <div class="chart-card">
          <h3>Top Customer (2026 YTD Sales)</h3>
          <div id="chart-monthly-top-customer-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>2025 vs 2026 vs 2026 Forecast</h3>
          <div id="chart-monthly-compare"></div>
        </div>
        <div class="chart-card">
          <h3>2025 vs 2026 vs 2026 Forecast (YTD)</h3>
          <div id="chart-monthly-compare-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>Regional Sales Comparison</h3>
          <div id="chart-monthly-region-comp"></div>
        </div>
        <div class="chart-card">
          <h3>Regional Sales Comparison (YTD)</h3>
          <div id="chart-monthly-region-comp-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>Category Sales Comparison</h3>
          <div id="chart-monthly-category-comp"></div>
        </div>
        <div class="chart-card">
          <h3>Category Sales Comparison (YTD)</h3>
          <div id="chart-monthly-category-comp-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>Category Mix by Year Type (YTD)</h3>
          <div id="chart-monthly-category-mix-ytd"></div>
        </div>
        <div class="chart-card table-card">
          <div class="table-header">
            <h3>Category Mix Table (Percent of Sales) (YTD)</h3>
            <div class="table-meta" id="monthly-category-mix-table-meta"></div>
          </div>
          <div class="table-wrap">
            <table id="monthly-category-mix-table">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Customer Increase 2025 (YTD)</h3>
          <div id="chart-monthly-2025-inc-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Customer Decrease 2025 (YTD)</h3>
          <div id="chart-monthly-2025-dec-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Customers Beating 2026 Forecast (YTD)</h3>
          <div id="chart-monthly-2026-beat-ytd"></div>
        </div>
        <div class="chart-card">
          <h3>Top 10 Customers Missing 2026 Forecast (YTD)</h3>
          <div id="chart-monthly-2026-miss-ytd"></div>
        </div>
      </section>

      <section class="table-section" id="monthly-table-section">
        <div class="table-header">
          <h3>Monthly Sales Table (Filtered)</h3>
          <div class="table-meta" id="monthly-table-meta"></div>
        </div>
        <div class="table-wrap">
          <table id="monthly-table">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="table-section" id="monthly-ytd-table-section">
        <div class="table-header">
          <h3>Year-to-Date Sales Table (Filtered)</h3>
          <div class="table-meta" id="monthly-ytd-table-meta"></div>
        </div>
        <div class="table-wrap">
          <table id="monthly-ytd-table">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </section>

    <section class="table-section" id="yearly-table-section">
      <div class="table-header">
        <h3>Raw Table (Filtered)</h3>
        <div class="table-meta" id="table-meta"></div>
      </div>
      <div class="table-wrap">
        <table id="data-table">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </main>

  <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
  <script src="encrypted-data.js"></script>
  <script src="crypto.js"></script>
  <script src="customer-map.js"></script>
  <script src="monthly-data.js"></script>
  <script src="app.js"></script>
  <script>
    document.getElementById("unlock-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const btn = document.getElementById("unlock-btn");
      const errEl = document.getElementById("unlock-error");
      const password = document.getElementById("password-input").value;

      btn.disabled = true;
      btn.textContent = "Decrypting\u2026";
      errEl.style.display = "none";

      try {
        const data = await decryptData(password);
        window.DATA = data;
        initDashboard();

        document.querySelectorAll(".dashboard-hidden").forEach((el) => el.classList.remove("dashboard-hidden"));
        const lockScreen = document.getElementById("lock-screen");
        lockScreen.classList.add("fade-out");
        setTimeout(() => lockScreen.remove(), 500);
      } catch (err) {
        errEl.textContent = "Incorrect password. Please try again.";
        errEl.style.display = "block";
        btn.disabled = false;
        btn.textContent = "Unlock";
        document.getElementById("password-input").select();
      }
    });
  </script>
</body>
</html>
